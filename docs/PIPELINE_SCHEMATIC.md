# SOC Attack Detection Pipeline Schematic

## Overview Diagram

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                        SOC REAL-TIME ATTACK DETECTION SYSTEM                          ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝


    ┌─────────────────────────────────────────────────────────────────────────────────┐
    │                              TWO INPUT METHODS                                   │
    └─────────────────────────────────────────────────────────────────────────────────┘

         METHOD 1: DATASET                              METHOD 2: PCAP FILE
         ══════════════════                             ═══════════════════

         ┌─────────────┐                                ┌─────────────┐
         │  UNSW-NB15  │                                │    PCAP     │
         │   Dataset   │                                │    File     │
         │   (CSV)     │                                │  (Traffic)  │
         └──────┬──────┘                                └──────┬──────┘
                │                                              │
                │ /attack cmd                                  │ /zeek pcap cmd
                │                                              │
                ▼                                              ▼
         ┌─────────────┐                                ┌─────────────┐
         │   Sample    │                                │    ZEEK     │
         │  Selection  │                                │   Parser    │
         │             │                                │   (WSL)     │
         └──────┬──────┘                                └──────┬──────┘
                │                                              │
                │ Raw sample with                              │ Generates
                │ 41 features + label                          │ conn.log
                │                                              │
                ▼                                              ▼
         ┌─────────────┐                                ┌─────────────┐
         │   Direct    │                                │   Feature   │
         │  Feature    │                                │   Mapping   │
         │ Extraction  │                                │ Zeek→UNSW   │
         └──────┬──────┘                                └──────┬──────┘
                │                                              │
                │                                              │
                └──────────────────┬───────────────────────────┘
                                   │
                                   │  41 Network Features
                                   │
                                   ▼
    ┌─────────────────────────────────────────────────────────────────────────────────┐
    │                                                                                 │
    │                        ┌───────────────────────────┐                            │
    │                        │                           │                            │
    │                        │   RANDOM FOREST CLASSIFIER│                            │
    │                        │                           │                            │
    │                        │   • Binary Classification │                            │
    │                        │   • 97.11% Accuracy       │                            │
    │                        │   • n_estimators: 300     │                            │
    │                        │   • class_weight: balanced│                            │
    │                        │                           │                            │
    │                        └─────────────┬─────────────┘                            │
    │                                      │                                          │
    │                       SHARED ML MODEL (Same for both methods)                   │
    │                                                                                 │
    └─────────────────────────────────────────────────────────────────────────────────┘
                                   │
                                   │ Prediction + Confidence
                                   │
                                   ▼
                        ┌───────────────────────────┐
                        │     ATTACK DETECTION      │
                        │                           │
                        │  • Normal or Attack       │
                        │  • Confidence Score       │
                        │  • MITRE ATT&CK ID        │
                        └─────────────┬─────────────┘
                                      │
                                      ▼
                        ┌───────────────────────────┐
                        │    REAL-TIME DASHBOARD    │
                        │                           │
                        │  ┌─────┐ ┌─────┐ ┌─────┐  │
                        │  │ ATK │ │ MON │ │ VIC │  │
                        │  │ VM  │ │ TOR │ │ VM  │  │
                        │  └─────┘ └─────┘ └─────┘  │
                        └───────────────────────────┘
```

---

## Detailed Feature Flow

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                              41 FEATURE EXTRACTION                                    ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝


    DATASET (Direct)                              ZEEK conn.log (Mapped)
    ════════════════                              ════════════════════════

    CSV Column          Feature                   Zeek Field → Feature
    ──────────────────────────                    ──────────────────────────
    dur            ──▶  dur                       duration      ──▶  dur
    proto          ──▶  proto                     proto         ──▶  proto
    service        ──▶  service                   service       ──▶  service
    state          ──▶  state                     conn_state    ──▶  state
    spkts          ──▶  spkts                     orig_pkts     ──▶  spkts
    dpkts          ──▶  dpkts                     resp_pkts     ──▶  dpkts
    sbytes         ──▶  sbytes                    orig_bytes    ──▶  sbytes
    dbytes         ──▶  dbytes                    resp_bytes    ──▶  dbytes
    sttl           ──▶  sttl                      (calculated)  ──▶  sttl
    dttl           ──▶  dttl                      (calculated)  ──▶  dttl
    sload          ──▶  sload                     (calculated)  ──▶  sload
    dload          ──▶  dload                     (calculated)  ──▶  dload
    ...            ──▶  ...                       ...           ──▶  ...
                        │                                            │
                        │                                            │
                        └────────────────┬───────────────────────────┘
                                         │
                                         ▼
                              ┌─────────────────────┐
                              │   41 FEATURES       │
                              │   (Numeric Vector)  │
                              └──────────┬──────────┘
                                         │
                                         ▼
                              ┌─────────────────────┐
                              │   ML PREDICTION     │
                              └─────────────────────┘
```

---

## Binary Classification Output

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                              CLASSIFICATION OUTPUT                                    ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝


                              ┌─────────────────────┐
                              │   RANDOM FOREST     │
                              │   (Binary)          │
                              └──────────┬──────────┘
                                         │
                    ┌────────────────────┼────────────────────┐
                    │                    │                    │
                    ▼                    ▼                    ▼
            ┌──────────────┐    ┌──────────────┐    ┌──────────────┐
            │    CLASS     │    │  CONFIDENCE  │    │    MITRE     │
            │  PREDICTION  │    │    SCORE     │    │   MAPPING    │
            └──────┬───────┘    └──────┬───────┘    └──────┬───────┘
                   │                   │                   │
                   ▼                   ▼                   ▼

    ┌────────────────────────────────────────────────────────────────────┐
    │                                                                    │
    │   CLASS        LABEL           DESCRIPTION                         │
    │   ─────        ─────           ───────────                         │
    │     0          Normal          Benign network traffic              │
    │     1          Attack          Malicious activity detected         │
    │                                                                    │
    │   ─────────────────────────────────────────────────────────────    │
    │                                                                    │
    │   ATTACK TYPES (from dataset ground truth):                        │
    │                                                                    │
    │   • DoS          → T1498 (Network DoS)                             │
    │   • Exploits     → T1190 (Exploit Public App)                      │
    │   • Recon        → T1046 (Network Service Scan)                    │
    │   • Backdoor     → T1059 (Command & Scripting)                     │
    │   • Fuzzers      → T1046 (Network Service Scan)                    │
    │   • Shellcode    → T1059 (Command & Scripting)                     │
    │   • Worms        → T1570 (Lateral Tool Transfer)                   │
    │   • Analysis     → T1595 (Active Scanning)                         │
    │   • Generic      → T1071 (Application Layer)                       │
    │                                                                    │
    └────────────────────────────────────────────────────────────────────┘
```

---

## Model Performance

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                              MODEL PERFORMANCE                                        ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝

    ┌─────────────────────────────────────────────────────────────────────┐
    │                    RANDOM FOREST BINARY CLASSIFIER                  │
    ├─────────────────────────────────────────────────────────────────────┤
    │                                                                     │
    │   Algorithm:        Random Forest                                   │
    │   n_estimators:     300                                             │
    │   class_weight:     balanced                                        │
    │   max_depth:        20                                              │
    │                                                                     │
    ├─────────────────────────────────────────────────────────────────────┤
    │                                                                     │
    │   ACCURACY:         97.11%                                          │
    │                                                                     │
    │   ┌─────────────┬───────────┬──────────┬──────────┐                 │
    │   │   Class     │ Precision │  Recall  │ F1-Score │                 │
    │   ├─────────────┼───────────┼──────────┼──────────┤                 │
    │   │   Normal    │   0.95    │   0.98   │   0.97   │                 │
    │   │   Attack    │   0.99    │   0.96   │   0.97   │                 │
    │   └─────────────┴───────────┴──────────┴──────────┘                 │
    │                                                                     │
    ├─────────────────────────────────────────────────────────────────────┤
    │                                                                     │
    │   CONFUSION MATRIX:                                                 │
    │                                                                     │
    │                        Predicted                                    │
    │                    Normal    Attack                                 │
    │   Actual Normal     7268       132                                  │
    │   Actual Attack      344      8723                                  │
    │                                                                     │
    │   True Negatives:   7268                                            │
    │   False Positives:   132                                            │
    │   False Negatives:   344                                            │
    │   True Positives:   8723                                            │
    │                                                                     │
    └─────────────────────────────────────────────────────────────────────┘
```

---

## System Architecture

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                              SYSTEM ARCHITECTURE                                      ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝


    ┌─────────────────────────────────────────────────────────────────────────────────┐
    │                                  FRONTEND                                       │
    │                                                                                 │
    │   ┌─────────────────────────────────────────────────────────────────────────┐   │
    │   │                     attack-detection-viz.html                           │   │
    │   │                                                                         │   │
    │   │   ┌───────────┐   ┌───────────┐   ┌───────────┐   ┌───────────┐        │   │
    │   │   │ Attacker  │   │  Network  │   │  Victim   │   │  Command  │        │   │
    │   │   │    VM     │   │  Monitor  │   │    VM     │   │ Terminal  │        │   │
    │   │   └───────────┘   └───────────┘   └───────────┘   └───────────┘        │   │
    │   │                                                                         │   │
    │   └─────────────────────────────────────────────────────────────────────────┘   │
    │                                      │                                          │
    │                                      │ WebSocket                                │
    │                                      │ ws://127.0.0.1:8765/ws                   │
    └──────────────────────────────────────┼──────────────────────────────────────────┘
                                           │
                                           ▼
    ┌─────────────────────────────────────────────────────────────────────────────────┐
    │                                  BACKEND                                        │
    │                                                                                 │
    │   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐        │
    │   │  server.py  │   │ simulator.py│   │ pipeline.py │   │ml_inference │        │
    │   │  WebSocket  │   │   Dataset   │   │    Zeek     │   │ RandomForest│        │
    │   │   Server    │   │  Sampling   │   │  Processing │   │   Wrapper   │        │
    │   └─────────────┘   └─────────────┘   └─────────────┘   └─────────────┘        │
    │                                                                                 │
    │   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐                          │
    │   │  mitre.py   │   │zeek_control │   │  config.py  │                          │
    │   │   ATT&CK    │   │    Zeek     │   │  Settings   │                          │
    │   │   Mapping   │   │   Manager   │   │             │                          │
    │   └─────────────┘   └─────────────┘   └─────────────┘                          │
    │                                                                                 │
    └─────────────────────────────────────────────────────────────────────────────────┘
                                           │
                    ┌──────────────────────┼──────────────────────┐
                    │                      │                      │
                    ▼                      ▼                      ▼
    ┌───────────────────────┐  ┌───────────────────┐  ┌───────────────────────┐
    │       Dataset/        │  │      model/       │  │        PCAP/          │
    │                       │  │                   │  │                       │
    │  UNSW-NB15_1.csv      │  │ rf_binary_        │  │  sample.pcap          │
    │  UNSW-NB15_2.csv      │  │ classifier.joblib │  │  malware.pcap         │
    │  UNSW-NB15_3.csv      │  │                   │  │  dos_attack.pcap      │
    │  UNSW-NB15_4.csv      │  │  (Random Forest)  │  │                       │
    │                       │  │                   │  │  (Traffic Captures)   │
    │  (Training Data)      │  │                   │  │                       │
    └───────────────────────┘  └───────────────────┘  └───────────────────────┘
```

---

## Comparison Table

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                           METHOD COMPARISON                                           ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝

┌──────────────────┬────────────────────────────┬────────────────────────────┐
│     ASPECT       │      DATASET METHOD        │      PCAP/ZEEK METHOD      │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│  Input Source    │  CSV files (pre-parsed)    │  Raw PCAP traffic          │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│  Processing      │  Direct feature read       │  Zeek → conn.log → map     │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│  Ground Truth    │  ✓ Available (labels)      │  ✗ Not available           │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│  Validation      │  Can verify accuracy       │  Blind prediction          │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│  Speed           │  Fast (no parsing)         │  Slower (Zeek overhead)    │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│  Use Case        │  Model testing/demo        │  Real-world detection      │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│  ML Model        │  Random Forest (Binary)    │  Random Forest (Binary)    │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│  Features        │  41 (direct)               │  41 (mapped)               │
└──────────────────┴────────────────────────────┴────────────────────────────┘
```

---

## Simple One-Page Summary

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                    SOC ATTACK DETECTION - PIPELINE SUMMARY                            ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝


     DATASET PATH                                    PCAP PATH
     ════════════                                    ═════════

    ┌──────────┐                                   ┌──────────┐
    │   CSV    │                                   │   PCAP   │
    │  Files   │                                   │   File   │
    └────┬─────┘                                   └────┬─────┘
         │                                              │
         ▼                                              ▼
    ┌──────────┐                                   ┌──────────┐
    │  Sample  │                                   │   ZEEK   │
    │  Select  │                                   │  Parser  │
    └────┬─────┘                                   └────┬─────┘
         │                                              │
         │                                              ▼
         │                                        ┌──────────┐
         │                                        │ Feature  │
         │                                        │   Map    │
         │                                        └────┬─────┘
         │                                              │
         └──────────────────┬───────────────────────────┘
                            │
                            ▼
                    ┌──────────────┐
                    │  41 FEATURES │
                    └──────┬───────┘
                           │
                           ▼
                    ┌──────────────┐
                    │ RANDOM FOREST│
                    │   (Binary)   │
                    │  (97.11%)    │
                    └──────┬───────┘
                           │
                           ▼
                    ┌──────────────┐
                    │  PREDICTION  │
                    │ Normal/Attack│
                    │  + MITRE ID  │
                    └──────┬───────┘
                           │
                           ▼
                    ┌──────────────┐
                    │  DASHBOARD   │
                    └──────────────┘


    KEY POINT: Both paths use the SAME trained ML model
               Binary classification: Normal (0) vs Attack (1)
               Accuracy: 97.11%
```
