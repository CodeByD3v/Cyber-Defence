# SOC Attack Detection Pipeline Schematic

## Overview Diagram

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                        SOC REAL-TIME ATTACK DETECTION SYSTEM                          ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝


    ┌─────────────────────────────────────────────────────────────────────────────────┐
    │                              TWO INPUT METHODS                                   │
    └─────────────────────────────────────────────────────────────────────────────────┘

         METHOD 1: DATASET                              METHOD 2: PCAP FILE
         ══════════════════                             ═══════════════════

         ┌─────────────┐                                ┌─────────────┐
         │  UNSW-NB15  │                                │    PCAP     │
         │   Dataset   │                                │    File     │
         │   (CSV)     │                                │  (Traffic)  │
         └──────┬──────┘                                └──────┬──────┘
                │                                              │
                │ /attack cmd                                  │ /zeek pcap cmd
                │                                              │
                ▼                                              ▼
         ┌─────────────┐                                ┌─────────────┐
         │   Sample    │                                │    ZEEK     │
         │  Selection  │                                │   Parser    │
         │             │                                │   (WSL)     │
         └──────┬──────┘                                └──────┬──────┘
                │                                              │
                │ Raw sample with                              │ Generates
                │ 41 features + label                          │ conn.log
                │                                              │
                ▼                                              ▼
         ┌─────────────┐                                ┌─────────────┐
         │   Direct    │                                │   Feature   │
         │  Feature    │                                │   Mapping   │
         │ Extraction  │                                │ Zeek→UNSW   │
         └──────┬──────┘                                └──────┬──────┘
                │                                              │
                │                                              │
                └──────────────────┬───────────────────────────┘
                                   │
                                   │  41 Network Features
                                   │
                                   ▼
    ┌─────────────────────────────────────────────────────────────────────────────────┐
    │                                                                                 │
    │                        ┌───────────────────────────┐                            │
    │                        │                           │                            │
    │                        │    XGBOOST CLASSIFIER     │                            │
    │                        │                           │                            │
    │                        │   • Multi-class (10)      │                            │
    │                        │   • 87.78% Accuracy       │                            │
    │                        │   • Threshold: 30%        │                            │
    │                        │                           │                            │
    │                        └─────────────┬─────────────┘                            │
    │                                      │                                          │
    │                       SHARED ML MODEL (Same for both methods)                   │
    │                                                                                 │
    └─────────────────────────────────────────────────────────────────────────────────┘
                                   │
                                   │ Prediction + Confidence
                                   │
                                   ▼
                        ┌───────────────────────────┐
                        │     ATTACK DETECTION      │
                        │                           │
                        │  • Attack Type            │
                        │  • Confidence Score       │
                        │  • MITRE ATT&CK ID        │
                        └─────────────┬─────────────┘
                                      │
                                      ▼
                        ┌───────────────────────────┐
                        │    REAL-TIME DASHBOARD    │
                        │                           │
                        │  ┌─────┐ ┌─────┐ ┌─────┐  │
                        │  │ ATK │ │ MON │ │ VIC │  │
                        │  │ VM  │ │ TOR │ │ VM  │  │
                        │  └─────┘ └─────┘ └─────┘  │
                        └───────────────────────────┘
```

---

## Detailed Feature Flow

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                              41 FEATURE EXTRACTION                                    ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝


    DATASET (Direct)                              ZEEK conn.log (Mapped)
    ════════════════                              ════════════════════════

    CSV Column          Feature                   Zeek Field → Feature
    ──────────────────────────                    ──────────────────────────
    dur            ──▶  dur                       duration      ──▶  dur
    proto          ──▶  proto                     proto         ──▶  proto
    service        ──▶  service                   service       ──▶  service
    state          ──▶  state                     conn_state    ──▶  state
    spkts          ──▶  spkts                     orig_pkts     ──▶  spkts
    dpkts          ──▶  dpkts                     resp_pkts     ──▶  dpkts
    sbytes         ──▶  sbytes                    orig_bytes    ──▶  sbytes
    dbytes         ──▶  dbytes                    resp_bytes    ──▶  dbytes
    sttl           ──▶  sttl                      (calculated)  ──▶  sttl
    dttl           ──▶  dttl                      (calculated)  ──▶  dttl
    sload          ──▶  sload                     (calculated)  ──▶  sload
    dload          ──▶  dload                     (calculated)  ──▶  dload
    ...            ──▶  ...                       ...           ──▶  ...
                        │                                            │
                        │                                            │
                        └────────────────┬───────────────────────────┘
                                         │
                                         ▼
                              ┌─────────────────────┐
                              │   41 FEATURES       │
                              │   (Numeric Vector)  │
                              └──────────┬──────────┘
                                         │
                                         ▼
                              ┌─────────────────────┐
                              │   ML PREDICTION     │
                              └─────────────────────┘
```

---

## Attack Classification Output

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                              CLASSIFICATION OUTPUT                                    ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝


                              ┌─────────────────────┐
                              │   XGBOOST MODEL     │
                              └──────────┬──────────┘
                                         │
                    ┌────────────────────┼────────────────────┐
                    │                    │                    │
                    ▼                    ▼                    ▼
            ┌──────────────┐    ┌──────────────┐    ┌──────────────┐
            │    CLASS     │    │  CONFIDENCE  │    │    MITRE     │
            │  PREDICTION  │    │    SCORE     │    │   MAPPING    │
            └──────┬───────┘    └──────┬───────┘    └──────┬───────┘
                   │                   │                   │
                   ▼                   ▼                   ▼

    ┌────────────────────────────────────────────────────────────────────┐
    │                                                                    │
    │   CLASS        ATTACK TYPE         MITRE ATT&CK                    │
    │   ─────        ───────────         ───────────                     │
    │     0          Normal              -                               │
    │     1          Analysis            T1595 (Active Scanning)         │
    │     2          Backdoor            T1059 (Command & Scripting)     │
    │     3          DoS                 T1498 (Network DoS)             │
    │     4          Exploits            T1190 (Exploit Public App)      │
    │     5          Fuzzers             T1046 (Network Service Scan)    │
    │     6          Generic             T1071 (Application Layer)       │
    │     7          Reconnaissance      T1046 (Network Service Scan)    │
    │     8          Shellcode           T1059 (Command & Scripting)     │
    │     9          Worms               T1570 (Lateral Tool Transfer)   │
    │                                                                    │
    └────────────────────────────────────────────────────────────────────┘
```

---

## System Architecture

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                              SYSTEM ARCHITECTURE                                      ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝


    ┌─────────────────────────────────────────────────────────────────────────────────┐
    │                                  FRONTEND                                       │
    │                                                                                 │
    │   ┌─────────────────────────────────────────────────────────────────────────┐   │
    │   │                     attack-detection-viz.html                           │   │
    │   │                                                                         │   │
    │   │   ┌───────────┐   ┌───────────┐   ┌───────────┐   ┌───────────┐        │   │
    │   │   │ Attacker  │   │  Network  │   │  Victim   │   │  Command  │        │   │
    │   │   │    VM     │   │  Monitor  │   │    VM     │   │ Terminal  │        │   │
    │   │   └───────────┘   └───────────┘   └───────────┘   └───────────┘        │   │
    │   │                                                                         │   │
    │   └─────────────────────────────────────────────────────────────────────────┘   │
    │                                      │                                          │
    │                                      │ WebSocket                                │
    │                                      │ ws://127.0.0.1:8765/ws                   │
    └──────────────────────────────────────┼──────────────────────────────────────────┘
                                           │
                                           ▼
    ┌─────────────────────────────────────────────────────────────────────────────────┐
    │                                  BACKEND                                        │
    │                                                                                 │
    │   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐        │
    │   │  server.py  │   │ simulator.py│   │ pipeline.py │   │ml_inference │        │
    │   │  WebSocket  │   │   Dataset   │   │    Zeek     │   │   XGBoost   │        │
    │   │   Server    │   │  Sampling   │   │  Processing │   │   Wrapper   │        │
    │   └─────────────┘   └─────────────┘   └─────────────┘   └─────────────┘        │
    │                                                                                 │
    │   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐                          │
    │   │  mitre.py   │   │zeek_control │   │  config.py  │                          │
    │   │   ATT&CK    │   │    Zeek     │   │  Settings   │                          │
    │   │   Mapping   │   │   Manager   │   │             │                          │
    │   └─────────────┘   └─────────────┘   └─────────────┘                          │
    │                                                                                 │
    └─────────────────────────────────────────────────────────────────────────────────┘
                                           │
                    ┌──────────────────────┼──────────────────────┐
                    │                      │                      │
                    ▼                      ▼                      ▼
    ┌───────────────────────┐  ┌───────────────────┐  ┌───────────────────────┐
    │       Dataset/        │  │      model/       │  │        PCAP/          │
    │                       │  │                   │  │                       │
    │  UNSW-NB15_1.csv      │  │ attack_classifier │  │  sample.pcap          │
    │  UNSW-NB15_2.csv      │  │    .joblib        │  │  malware.pcap         │
    │  UNSW-NB15_3.csv      │  │                   │  │  dos_attack.pcap      │
    │  UNSW-NB15_4.csv      │  │  (Trained Model)  │  │                       │
    │                       │  │                   │  │  (Traffic Captures)   │
    │  (Training Data)      │  │                   │  │                       │
    └───────────────────────┘  └───────────────────┘  └───────────────────────┘
```

---

## Comparison Table

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                           METHOD COMPARISON                                           ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝

┌──────────────────┬────────────────────────────┬────────────────────────────┐
│     ASPECT       │      DATASET METHOD        │      PCAP/ZEEK METHOD      │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│                  │                            │                            │
│  Input Source    │  CSV files (pre-parsed)    │  Raw PCAP traffic          │
│                  │                            │                            │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│                  │                            │                            │
│  Processing      │  Direct feature read       │  Zeek → conn.log → map     │
│                  │                            │                            │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│                  │                            │                            │
│  Ground Truth    │  ✓ Available (labels)      │  ✗ Not available           │
│                  │                            │                            │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│                  │                            │                            │
│  Validation      │  Can verify accuracy       │  Blind prediction          │
│                  │                            │                            │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│                  │                            │                            │
│  Speed           │  Fast (no parsing)         │  Slower (Zeek overhead)    │
│                  │                            │                            │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│                  │                            │                            │
│  Use Case        │  Model testing/demo        │  Real-world detection      │
│                  │                            │                            │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│                  │                            │                            │
│  ML Model        │  Same XGBoost              │  Same XGBoost              │
│                  │                            │                            │
├──────────────────┼────────────────────────────┼────────────────────────────┤
│                  │                            │                            │
│  Features        │  41 (direct)               │  41 (mapped)               │
│                  │                            │                            │
└──────────────────┴────────────────────────────┴────────────────────────────┘
```

---

## Simple One-Page Summary

```
╔═══════════════════════════════════════════════════════════════════════════════════════╗
║                    SOC ATTACK DETECTION - PIPELINE SUMMARY                            ║
╚═══════════════════════════════════════════════════════════════════════════════════════╝


     DATASET PATH                                    PCAP PATH
     ════════════                                    ═════════

    ┌──────────┐                                   ┌──────────┐
    │   CSV    │                                   │   PCAP   │
    │  Files   │                                   │   File   │
    └────┬─────┘                                   └────┬─────┘
         │                                              │
         ▼                                              ▼
    ┌──────────┐                                   ┌──────────┐
    │  Sample  │                                   │   ZEEK   │
    │  Select  │                                   │  Parser  │
    └────┬─────┘                                   └────┬─────┘
         │                                              │
         │                                              ▼
         │                                        ┌──────────┐
         │                                        │ Feature  │
         │                                        │   Map    │
         │                                        └────┬─────┘
         │                                              │
         └──────────────────┬───────────────────────────┘
                            │
                            ▼
                    ┌──────────────┐
                    │  41 FEATURES │
                    └──────┬───────┘
                           │
                           ▼
                    ┌──────────────┐
                    │   XGBOOST    │
                    │    MODEL     │
                    │  (87.78%)    │
                    └──────┬───────┘
                           │
                           ▼
                    ┌──────────────┐
                    │  PREDICTION  │
                    │  + MITRE ID  │
                    └──────┬───────┘
                           │
                           ▼
                    ┌──────────────┐
                    │  DASHBOARD   │
                    └──────────────┘


    KEY POINT: Both paths use the SAME trained ML model
               Only the feature extraction method differs
```
